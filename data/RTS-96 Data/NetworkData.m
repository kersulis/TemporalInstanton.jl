%MVA Base for Per Unit Calc:
Sb=100;

%busdata:
%Format:
%   BUS    BUS    MW   MVAR        Sub   Base  Zone
%   NAME   TYPE  LOAD  LOAD GL BL  Area  kV    #
nodedata=[
    101     2    108   22   0  0   11   138   11
    102     2     97   20   0  0   11   138   12
    103     1    180   37   0  0   11   138   11
    104     1     74   15   0  0   11   138   11
    105     1     71   14   0  0   11   138   11
    106     1    136   28   0 1.00 11   138   12
    107     2    125   25   0  0   11   138   12
    108     1    171   35   0  0   11   138   12
    109     1    175   36   0  0   11   138   13
    110     1    195   40   0  0   11   138   13
    111     1      0    0   0  0   11   230   13
    112     1      0    0   0  0   11   230   13
    113     3    265   54   0  0   12   230   14
    114     2    194   39   0  0   12   230   16
    115     2    317   64   0  0   12   230   16
    116     2    100   20   0  0   12   230   16
    117     1      0    0   0  0   12   230   17
    118     2    333   68   0  0   12   230   17
    119     1    181   37   0  0   12   230   15
    120     1    128   26   0  0   12   230   15
    121     2      0    0   0  0   12   230   17
    122     2      0    0   0  0   12   230   17
    123     2      0    0   0  0   12   230   15
    124     1      0    0   0  0   12   230   16
    201     2    108   22   0  0   21   138   21
    202     2     97   20   0  0   21   138   22
    203     1    180   37   0  0   21   138   21
    204     1     74   15   0  0   21   138   21
    205     1     71   14   0  0   21   138   21
    206     1    136   28   0 1.00 21   138   22
    207     2    125   25   0  0   21   138   22
    208     1    171   35   0  0   21   138   22
    209     1    175   36   0  0   21   138   23
    210     1    195   40   0  0   21   138   23
    211     1      0    0   0  0   21   230   23
    212     1      0    0   0  0   21   230   23
    213     2    265   54   0  0   22   230   24
    214     2    194   39   0  0   22   230   26
    215     2    317   64   0  0   22   230   26
    216     2    100   20   0  0   22   230   26
    217     1      0    0   0  0   22   230   27
    218     2    333   68   0  0   22   230   27
    219     1    181   37   0  0   22   230   25
    220     1    128   26   0  0   22   230   25
    221     2      0    0   0  0   22   230   27
    222     2      0    0   0  0   22   230   27
    223     2      0    0   0  0   22   230   25
    224     1      0    0   0  0   22   230   26
    301     2    108   22   0  0   31   138   31
    302     2     97   20   0  0   31   138   32
    303     1    180   37   0  0   31   138   31
    304     1     74   15   0  0   31   138   31
    305     1     71   14   0  0   31   138   31
    306     1    136   28   0 1.00 31   138   32
    307     2    125   25   0  0   31   138   32
    308     1    171   35   0  0   31   138   32
    309     1    175   36   0  0   31   138   33
    310     1    195   40   0  0   31   138   33
    311     1      0    0   0  0   31   230   33
    312     1      0    0   0  0   31   230   33
    313     2    265   54   0  0   32   230   34
    314     2    194   39   0  0   32   230   36
    315     2    317   64   0  0   32   230   36
    316     2    100   20   0  0   32   230   36
    317     1      0    0   0  0   32   230   37
    318     2    333   68   0  0   32   230   37
    319     1    181   37   0  0   32   230   35
    320     1    128   26   0  0   32   230   35
    321     2      0    0   0  0   32   230   37
    322     2      0    0   0  0   32   230   37
    323     2      0    0   0  0   32   230   35
    324     1      0    0   0  0   32   230   36
    325     1      0    0   0  0   32   230   35
];
nodedata(:,3:4)=nodedata(:,3:4)/Sb;

%gendata
%Format:
%   Bus    ID    PG    QG      Qmax    Qmin   VS
%   ID     #     MW    MVAR    MVAR    MVAR   pu
gendata=[
    101     1    10     0       10       0    1.035
    101     2    10     0       10       0    1.035
    101     3    76    14.1     30     -25    1.035
    101     4    76    14.1     30     -25    1.035
    102     1    10     0       10       0    1.035
    102     2    10     0       10       0    1.035
    102     3    76     7.0     30     -25    1.035
    102     4    76     7.0     30     -25    1.035
    107     1    80    17.2     60       0    1.025
    107     2    80    17.2     60       0    1.025
    107     3    80    17.2     60       0    1.025
    113     1    95.1  40.7     80       0    1.020
    113     2    95.1  40.7     80       0    1.020
    113     3    95.1  40.7     80       0    1.020
    114     1     0    13.7    200     -50    0.980
    115     1    12     0        6       0    1.014
    115     2    12     0        6       0    1.014
    115     3    12     0        6       0    1.014
    115     4    12     0        6       0    1.014
    115     5    12     0        6       0    1.014
    115     6   155     0.05    80     -50    1.014
    116     1   155    25.22    80     -50    1.017
    118     1   400   137.4    200     -50    1.050
    121     1   400   108.2    200     -50    1.050
    122     1    50    -4.96    16     -10    1.050
    122     2    50    -4.96    16     -10    1.050
    122     3    50    -4.96    16     -10    1.050
    122     4    50    -4.96    16     -10    1.050
    122     5    50    -4.96    16     -10    1.050
    122     6    50    -4.96    16     -10    1.050
    123     1   155    31.79    80     -50    1.050
    123     2   155    31.79    80     -50    1.050
    123     3   350    71.78   150     -25    1.050
    201     1    10     0       10       0    1.035
    201     2    10     0       10       0    1.035
    201     3    76    14.1     30     -25    1.035
    201     4    76    14.1     30     -25    1.035
    202     1    10     0       10       0    1.035
    202     2    10     0       10       0    1.035
    202     3    76     7.0     30     -25    1.035
    202     4    76     7.0     30     -25    1.035
    207     1    80    17.2     60       0    1.025
    207     2    80    17.2     60       0    1.025
    207     3    80    17.2     60       0    1.025
    213     1    95.1  40.7     80       0    1.020
    213     2    95.1  40.7     80       0    1.020
    213     3    95.1  40.7     80       0    1.020
    214     1     0    13.68   200     -50    0.980
    215     1    12     0        6       0    1.014
    215     2    12     0        6       0    1.014
    215     3    12     0        6       0    1.014
    215     4    12     0        6       0    1.014
    215     5    12     0        6       0    1.014
    215     6   155     0.048   80     -50    1.014
    216     1   155    25.22    80     -50    1.017
    218     1   400   137.4    200     -50    1.050
    221     1   400   108.2    200     -50    1.050
    222     1    50    -4.96    16     -10    1.050
    222     2    50    -4.96    16     -10    1.050
    222     3    50    -4.96    16     -10    1.050
    222     4    50    -4.96    16     -10    1.050
    222     5    50    -4.96    16     -10    1.050
    222     6    50    -4.96    16     -10    1.050
    223     1   155    31.79    80     -50    1.050
    223     2   155    31.79    80     -50    1.050
    223     3   350    71.78   150     -25    1.050
    301     1    10     0       10       0    1.035
    301     2    10     0       10       0    1.035
    301     3    76    14.1     30     -25    1.035
    301     4    76    14.1     30     -25    1.035
    302     1    10     0       10       0    1.035
    302     2    10     0       10       0    1.035
    302     3    76     7.0     30     -25    1.035
    302     4    76     7.0     30     -25    1.035
    307     1    80    17.2     60       0    1.025
    307     2    80    17.2     60       0    1.025
    307     3    80    17.2     60       0    1.025
    313     1    95.1  40.7     80       0    1.02    
    313     2    95.1  40.7     80       0    1.02    
    313     3    95.1  40.7     80       0    1.02    
    314     1     0    13.68   200     -50    0.98    
    315     1    12     0        6       0    1.014
    315     2    12     0        6       0    1.014
    315     3    12     0        6       0    1.014
    315     4    12     0        6       0    1.014
    315     5    12     0        6       0    1.014
    315     6   155     0.048   80     -50    1.014
    316     1   155    25.22    80     -50    1.017
    318     1   400   137.4    200     -50    1.05
    321     1   400   108.2    200     -50    1.05
    322     1    50    -4.96    16     -10    1.05
    322     2    50    -4.96    16     -10    1.05
    322     3    50    -4.96    16     -10    1.05
    322     4    50    -4.96    16     -10    1.05
    322     5    50    -4.96    16     -10    1.05
    322     6    50    -4.96    16     -10    1.05
    323     1   155    31.79    80     -50    1.05
    323     2   155    31.79    80     -50    1.05
    323     3   350    71.78   150     -25    1.05
    ];
gendata(:,3:6)=gendata(:,3:6)/Sb;

%Line data:
%Format:
% From  To    L -  Perm.     Tran.   R     X    B   Con LTE STE Tr
% Bus Bus   miles  Lam-p Dur Lam-t   pu    pu   pu  MVA MVA MVA pu
branchdata = [
    101 102   3   .24    16  0.0  0.003 0.014 0.461 175 193 200 0
    101 103  55   .51    10  2.9  0.055 0.211 0.057 175 208 220 0
    101 105  22   .33    10  1.2  0.022 0.085 0.023 175 208 220 0
    102 104  33   .39    10  1.7  0.033 0.127 0.034 175 208 220 0
    102 106  50   .48    10  2.6  0.050 0.192 0.052 175 208 220 0
    103 109  31   .38    10  1.6  0.031 0.119 0.032 175 208 220 0
    103 124   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.015
    104 109  27   .36    10  1.4  0.027 0.104 0.028 175 208 220 0
    105 110  23   .34    10  1.2  0.023 0.088 0.024 175 208 220 0
    106 110  16   .33    35  0.0  0.014 0.061 2.459 175 193 200 0
    107 108  16   .30    10  0.8  0.016 0.061 0.017 175 208 220 0
    107 203  42   .44    10  2.2  0.042 0.161 0.044 175 208 220 0
    108 109  43   .44    10  2.3  0.043 0.165 0.045 175 208 220 0
    108 110  43   .44    10  2.3  0.043 0.165 0.045 175 208 220 0
    109 111   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.03
    109 112   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.03
    110 111   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.015
    110 112   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.015
    111 113  33   .40    11  0.8  0.006 0.048 0.100 500 600 625 0
    111 114  29   .39    11  0.7  0.005 0.042 0.088 500 600 625 0
    112 113  33   .40    11  0.8  0.006 0.048 0.100 500 600 625 0
    112 123  67   .52    11  1.6  0.012 0.097 0.203 500 600 625 0
    113 123  60   .49    11  1.5  0.011 0.087 0.182 500 600 625 0
    113 215  52   .47    11  1.3  0.010 0.075 0.158 500 600 625 0
    114 116  27   .38    11  0.7  0.005 0.059 0.082 500 600 625 0
    115 116  12   .33    11  0.3  0.002 0.017 0.036 500 600 625 0
    115 121  34   .41    11  0.8  0.006 0.049 0.103 500 600 625 0
    115 121  34   .41    11  0.8  0.006 0.049 0.103 500 600 625 0
    115 124  36   .41    11  0.9  0.007 0.052 0.109 500 600 625 0
    116 117  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    116 119  16   .34    11  0.4  0.003 0.023 0.049 500 600 625 0
    117 118  10   .32    11  0.2  0.002 0.014 0.030 500 600 625 0
    117 122  73   .54    11  1.8  0.014 0.105 0.221 500 600 625 0
    118 121  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    118 121  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    119 120  27.5 .38    11  0.7  0.005 0.040 0.083 500 600 625 0
    119 120  27.5 .38    11  0.7  0.005 0.040 0.083 500 600 625 0
    120 123  15   .34    11  0.4  0.003 0.022 0.046 500 600 625 0
    120 123  15   .34    11  0.4  0.003 0.022 0.046 500 600 625 0
    121 122  47   .45    11  1.2  0.009 0.068 0.142 500 600 625 0
    123 217  51   .46    11  1.3  0.010 0.074 0.155 500 600 625 0
    201 202   3   .24    16  0.0  0.003 0.014 0.461 175 193 200 0
    201 203  55   .51    10  2.9  0.055 0.211 0.057 175 208 220 0
    201 205  22   .33    10  1.2  0.022 0.085 0.023 175 208 220 0
    202 204  33   .39    10  1.7  0.033 0.127 0.034 175 208 220 0
    202 206  50   .48    10  2.6  0.050 0.192 0.052 175 208 220 0
    203 209  31   .38    10  1.6  0.031 0.119 0.032 175 208 220 0
    203 224   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.015
    204 209  27   .36    10  1.4  0.027 0.104 0.028 175 208 220 0
    205 210  23   .34    10  1.2  0.023 0.088 0.024 175 208 220 0
    206 210  16   .33    35  0.0  0.014 0.061 2.459 175 193 200 0
    207 208  16   .30    10  0.8  0.016 0.061 0.017 175 208 220 0
    208 209  43   .44    10  2.3  0.043 0.165 0.045 175 208 220 0
    208 210  43   .44    10  2.3  0.043 0.165 0.045 175 208 220 0
    209 211   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.03
    209 212   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.03
    210 211   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.015
    210 212   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.015
    211 213  33   .40    11  0.8  0.006 0.048 0.100 500 600 625 0
    211 214  29   .39    11  0.7  0.005 0.042 0.088 500 600 625 0
    212 213  33   .40    11  0.8  0.006 0.048 0.100 500 600 625 0
    212 223  67   .52    11  1.6  0.012 0.097 0.203 500 600 625 0
    213 223  60   .49    11  1.5  0.011 0.087 0.182 500 600 625 0
    214 216  27   .38    11  0.7  0.005 0.059 0.082 500 600 625 0
    215 216  12   .33    11  0.3  0.002 0.017 0.036 500 600 625 0
    215 221  34   .41    11  0.8  0.006 0.049 0.103 500 600 625 0
    215 221  34   .41    11  0.8  0.006 0.049 0.103 500 600 625 0
    215 224  36   .41    11  0.9  0.007 0.052 0.109 500 600 625 0
    216 217  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    216 219  16   .34    11  0.4  0.003 0.023 0.049 500 600 625 0
    217 218  10   .32    11  0.2  0.002 0.014 0.030 500 600 625 0
    217 222  73   .54    11  1.8  0.014 0.105 0.221 500 600 625 0
    218 221  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    218 221  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    219 220  27.5 .38    11  0.7  0.005 0.040 0.083 500 600 625 0
    219 220  27.5 .38    11  0.7  0.005 0.040 0.083 500 600 625 0
    220 223  15   .34    11  0.4  0.003 0.022 0.046 500 600 625 0
    220 223  15   .34    11  0.4  0.003 0.022 0.046 500 600 625 0
    221 222  47   .45    11  1.2  0.009 0.068 0.142 500 600 625 0
    301 302   3   .24    16  0.0  0.003 0.014 0.461 175 193 200 0
    301 303  55   .51    10  2.9  0.055 0.211 0.057 175 208 220 0
    301 305  22   .33    10  1.2  0.022 0.085 0.023 175 208 220 0
    302 304  33   .39    10  1.7  0.033 0.127 0.034 175 208 220 0
    302 306  50   .48    10  2.6  0.050 0.192 0.052 175 208 220 0
    303 309  31   .38    10  1.6  0.031 0.119 0.032 175 208 220 0
    303 324   0   .02   768  0.0  0.002 0.084 0 400 510 600 1.015
    304 309  27   .36    10  1.4  0.027 0.104 0.028 175 208 220 0
    305 310  23   .34    10  1.2  0.023 0.088 0.024 175 208 220 0
    306 310  16   .33    35  0.0  0.014 0.061 2.459 175 193 200 0
    307 308  16   .30    10  0.8  0.016 0.061 0.017 175 208 220 0
    308 309  43   .44    10  2.3  0.043 0.165 0.045 175 208 220 0
    308 310  43   .44    10  2.3  0.043 0.165 0.045 175 208 220 0
    309 311   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.03
    309 312   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.03
    310 311   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.015
    310 312   0   .02   768  0.0  0.002 0.084 0     400 510 600 1.015
    311 313  33   .40    11  0.8  0.006 0.048 0.100 500 600 625 0
    311 314  29   .39    11  0.7  0.005 0.042 0.088 500 600 625 0
    312 313  33   .40    11  0.8  0.006 0.048 0.100 500 600 625 0
    312 323  67   .52    11  1.6  0.012 0.097 0.203 500 600 625 0
    313 323  60   .49    11  1.5  0.011 0.087 0.182 500 600 625 0
    314 316  27   .38    11  0.7  0.005 0.059 0.082 500 600 625 0
    315 316  12   .33    11  0.3  0.002 0.017 0.036 500 600 625 0
    315 321  34   .41    11  0.8  0.006 0.049 0.103 500 600 625 0
    315 321  34   .41    11  0.8  0.006 0.049 0.103 500 600 625 0
    315 324  36   .41    11  0.9  0.007 0.052 0.109 500 600 625 0
    316 317  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    316 319  16   .34    11  0.4  0.003 0.023 0.049 500 600 625 0
    317 318  10   .32    11  0.2  0.002 0.014 0.030 500 600 625 0
    317 322  73   .54    11  1.8  0.014 0.105 0.221 500 600 625 0
    318 321  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    318 321  18   .35    11  0.4  0.003 0.026 0.055 500 600 625 0
    319 320  27.5 .38    11  0.7  0.005 0.040 0.083 500 600 625 0
    319 320  27.5 .38    11  0.7  0.005 0.040 0.083 500 600 625 0
    320 323  15   .34    11  0.4  0.003 0.022 0.046 500 600 625 0
    320 323  15   .34    11  0.4  0.003 0.022 0.046 500 600 625 0
    321 322  47   .45    11  1.2  0.009 0.068 0.142 500 600 625 0
    325 121  67   .52    11  1.6  0.012 0.097 0.203 500 600 625 0
    318 223  72   .53    11  1.8  0.013 0.104 0.218 500 600 625 0
    323 325   0   .02   768  0.0  0.000 0.009 0     722 893 893 1.00
     ];
branchdata(:,10:12)=branchdata(:,10:12)/Sb;
% branchdata(:,10:12)=0.70*branchdata(:,10:12);
branchdata(:,10:12)=0.80*branchdata(:,10:12);
% branchdata(:,10:12)=1.011*branchdata(:,10:12);




    